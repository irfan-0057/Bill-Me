<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bismilla Traders - Reports</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="sidebar">
        <a href="{{ url_for('dashboard') }}" class="sidebar-item">Dashboard</a>
        <a href="{{ url_for('inventory_selection') }}" class="sidebar-item">Inventory</a>
        <a href="{{ url_for('billing_selection') }}" class="sidebar-item">Billing</a>
        <a href="{{ url_for('bills') }}" class="sidebar-item">Bills</a>
        <a href="{{ url_for('reports') }}" class="sidebar-item active">Reports</a>
    </div>

    <div class="content">
        <h1>Sales Reports</h1>
        <div class="form-section">
            <div class="report-form">
                <div class="input-group">
                    <label for="reportType">Report Type:</label>
                    <select id="reportType">
                        <option value="daily_sales">Daily Sales</option>
                        <option value="monthly_sales">Monthly Sales</option>
                        <option value="yearly_sales">Yearly Sales</option>
                        <option value="total_sales">Total Sales</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="reportScope">Report Scope:</label>
                    <select id="reportScope">
                        <option value="total">Total Products</option>
                        <option value="product_wise">Product-wise</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="startDate">Start Date:</label>
                    <input type="date" id="startDate" required>
                </div>
                <div class="input-group">
                    <label for="endDate">End Date:</label>
                    <input type="date" id="endDate" required>
                </div>
                <button id="generateReportBtn" class="button primary">Generate PDF Report</button>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const reportTypeSelect = document.getElementById('reportType');
            const reportScopeSelect = document.getElementById('reportScope');
            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');
            const generateReportBtn = document.getElementById('generateReportBtn');

            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            startDateInput.value = today;
            endDateInput.value = today;

            generateReportBtn.addEventListener('click', function() {
                const reportType = reportTypeSelect.value;
                const reportScope = reportScopeSelect.value;
                const startDate = startDateInput.value;
                const endDate = endDateInput.value;

                if (!startDate || !endDate) {
                    alert('Please select both a start and an end date.');
                    return;
                }

                // Construct the URL to the new sales_report API endpoint
                const url = `/sales_report?type=${reportType}&scope=${reportScope}&start_date=${startDate}&end_date=${endDate}`;

                // Open the URL in a new tab, which will trigger the PDF download/view
                window.open(url, '_blank');
            });
        });
    </script>
</body>
</html>
